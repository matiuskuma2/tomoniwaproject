{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "version": "2026-01-28-b5",
  "description": "AI会話化ロードマップ用 Intent Catalog - nlRouterの許可リスト",

  "principles": {
    "ai_role": "interpret_only",
    "execution": "rule_executor_only",
    "external_side_effect": "always_confirm"
  },

  "side_effect_types": {
    "none": "副作用なし（キャンセル系）",
    "read": "参照のみ（安全）",
    "write_local": "DB更新など（外部送信なし）",
    "write_external": "メール/SMS/Slack/Chatwork等（必ず確認）"
  },

  "intents": [
    {
      "intent": "schedule.today",
      "category": "calendar.read",
      "description": "今日の予定を取得",
      "side_effect": "read",
      "requires_confirmation": false,
      "topology": "1:0",
      "params_schema": {
        "date": { "type": "string", "format": "date", "optional": true }
      },
      "executor": "calendar.today",
      "api": "GET /api/calendar/today"
    },
    {
      "intent": "schedule.week",
      "category": "calendar.read",
      "description": "今週の予定を取得",
      "side_effect": "read",
      "requires_confirmation": false,
      "topology": "1:0",
      "params_schema": {
        "week_offset": { "type": "integer", "optional": true }
      },
      "executor": "calendar.week",
      "api": "GET /api/calendar/week"
    },
    {
      "intent": "schedule.freebusy",
      "category": "calendar.read",
      "description": "自分の空き時間/空き枠を取得",
      "side_effect": "read",
      "requires_confirmation": false,
      "topology": "1:1",
      "params_schema": {
        "range": { "type": "string", "enum": ["today", "week", "next_week"], "required": true },
        "prefer": { "type": "string", "enum": ["morning", "afternoon", "evening", "business"], "optional": true },
        "meetingLength": { "type": "integer", "default": 60, "optional": true }
      },
      "executor": "calendar.freebusy",
      "api": "GET /api/calendar/freebusy"
    },
    {
      "intent": "schedule.freebusy.batch",
      "category": "calendar.read.multi",
      "description": "複数参加者の共通空き時間を取得（P3-INTERSECT1）",
      "side_effect": "read",
      "requires_confirmation": false,
      "topology": "N:N",
      "params_schema": {
        "threadId": { "type": "string", "optional": true },
        "participants": { "type": "array", "optional": true },
        "range": { "type": "string", "enum": ["today", "week", "next_week"], "default": "week" },
        "prefer": { "type": "string", "optional": true },
        "meetingLength": { "type": "integer", "default": 60, "optional": true }
      },
      "executor": "calendar.freebusy.batch",
      "api": "POST /api/calendar/freebusy/batch"
    },

    {
      "intent": "schedule.status.check",
      "category": "thread.read",
      "description": "スレッドの状況確認",
      "side_effect": "read",
      "requires_confirmation": false,
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true, "source": "selectedThreadId" }
      },
      "executor": "thread.status",
      "api": "GET /api/threads/:id/status"
    },
    {
      "intent": "schedule.invite.list",
      "category": "thread.read",
      "description": "招待者一覧を取得",
      "side_effect": "read",
      "requires_confirmation": false,
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true }
      },
      "executor": "thread.invites",
      "api": "GET /api/threads/:id/invites"
    },

    {
      "intent": "schedule.1on1.fixed",
      "category": "schedule.1on1",
      "description": "1対1固定日時の招待リンク発行（メール未知でもOK）",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "topology": "1:1",
      "params_schema": {
        "invitee": {
          "type": "object",
          "required": true,
          "properties": {
            "name": { "type": "string", "required": true, "description": "相手の名前" },
            "email": { "type": "string", "format": "email", "optional": true, "description": "メールアドレス（未知でもOK）" }
          }
        },
        "slot": {
          "type": "object",
          "required": true,
          "properties": {
            "start_at": { "type": "string", "format": "date-time", "required": true, "description": "開始日時（ISO8601）" },
            "end_at": { "type": "string", "format": "date-time", "required": true, "description": "終了日時（ISO8601）" }
          }
        },
        "title": { "type": "string", "optional": true, "default": "打ち合わせ", "description": "予定タイトル" },
        "message_hint": { "type": "string", "optional": true, "description": "相手に伝えるメッセージ" },
        "send_via": { "type": "string", "enum": ["share_link", "email"], "default": "share_link", "description": "送信手段" }
      },
      "clarify_rules": {
        "start_at_missing": "いつの予定ですか？日時を教えてください。",
        "invitee_name_missing": "誰との予定ですか？相手の名前を教えてください。",
        "duration_default": 60,
        "timezone_default": "Asia/Tokyo"
      },
      "outputs": {
        "share_url": "招待リンク（https://app.tomoniwao.jp/i/:token）",
        "message_for_chat": "AI秘書がユーザーに返す文章（コピペ用文言含む）",
        "thread_id": "作成されたスレッドID",
        "invite_token": "招待トークン",
        "mode": "share_link または email"
      },
      "executor": "frontend:executors/oneOnOne.ts::executeOneOnOneFixed",
      "api": "POST /api/one-on-one/fixed/prepare",
      "examples": [
        "Aさんと来週木曜17時から1時間打ち合わせしたい",
        "田中さんと明日の14時から30分ミーティング",
        "佐藤さんと1/30の10時から予定調整お願い"
      ],
      "ui_flow": {
        "invite_page": "/i/:token - 固定1枠UI（「この日時でOKですか？」）",
        "thank_you_page": "/i/:token/thank-you - 承諾後（Googleカレンダー追加 + 成長導線）"
      },
      "notes": "v1.0 AI秘書の最小構成。メールアドレス未知でもURL発行で完結する。"
    },

    {
      "intent": "schedule.1on1.candidates3",
      "category": "schedule.1on1",
      "description": "1対1候補3つの招待リンク発行（メール未知でもOK）- Phase B-1",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "topology": "1:1",
      "params_schema": {
        "invitee": {
          "type": "object",
          "required": true,
          "properties": {
            "name": { "type": "string", "required": true, "description": "相手の名前" },
            "email": { "type": "string", "format": "email", "optional": true, "description": "メールアドレス（未知でもOK）" }
          }
        },
        "slots": {
          "type": "array",
          "required": true,
          "minItems": 1,
          "maxItems": 5,
          "items": {
            "type": "object",
            "properties": {
              "start_at": { "type": "string", "format": "date-time", "required": true },
              "end_at": { "type": "string", "format": "date-time", "required": true }
            }
          },
          "description": "候補枠（1〜5件）"
        },
        "title": { "type": "string", "optional": true, "default": "打ち合わせ", "description": "予定タイトル" },
        "message_hint": { "type": "string", "optional": true, "description": "相手に伝えるメッセージ" },
        "send_via": { "type": "string", "enum": ["share_link", "email"], "default": "share_link", "description": "送信手段" }
      },
      "clarify_rules": {
        "slots_missing": "いつの候補がありますか？複数の候補日時を教えてください。",
        "invitee_name_missing": "誰との予定ですか？相手の名前を教えてください。",
        "duration_default": 60,
        "timezone_default": "Asia/Tokyo"
      },
      "outputs": {
        "share_url": "招待リンク（https://app.tomoniwao.jp/i/:token）",
        "message_for_chat": "AI秘書がユーザーに返す文章（候補リスト含む）",
        "thread_id": "作成されたスレッドID",
        "invite_token": "招待トークン",
        "slots": "作成された候補枠（slot_id, start_at, end_at）",
        "mode": "share_link または email"
      },
      "executor": "frontend:executors/oneOnOne.ts::executeOneOnOneCandidates",
      "api": "POST /api/one-on-one/candidates/prepare",
      "examples": [
        "Aさんと来週の火曜14時、水曜10時、木曜15時のどれかで打ち合わせしたい",
        "田中さんに3つ候補を出して日程調整したい",
        "佐藤さんと打ち合わせ、1/30 10時、1/31 14時、2/1 16時のどれかで"
      ],
      "ui_flow": {
        "invite_page": "/i/:token - 複数候補UI（multiSlotUI）",
        "thank_you_page": "/i/:token/thank-you - 承諾後（Googleカレンダー追加 + 成長導線）"
      },
      "notes": "Phase B-1: 候補3つ提示。slot_policy='fixed_multi'でDB登録。"
    },

    {
      "intent": "schedule.1on1.freebusy",
      "category": "schedule.1on1",
      "description": "主催者のGoogleカレンダーfreebusyから空き枠を生成し、候補3つで他人に日程確認リンクを作る（R0: 他人、カレンダー非共有）- Phase B-2",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "topology": "1:1",
      "params_schema": {
        "invitee": {
          "type": "object",
          "required": true,
          "properties": {
            "name": { "type": "string", "required": true, "description": "相手の名前" },
            "email": { "type": "string", "format": "email", "optional": true, "description": "メールアドレス（send_via=email時は必須）" }
          }
        },
        "constraints": {
          "type": "object",
          "optional": true,
          "properties": {
            "time_min": { "type": "string", "format": "date-time", "optional": true, "description": "検索開始（デフォルト: 翌営業日09:00）" },
            "time_max": { "type": "string", "format": "date-time", "optional": true, "description": "検索終了（デフォルト: 2週間後）" },
            "prefer": { "type": "string", "enum": ["morning", "afternoon", "evening", "business", "any"], "optional": true, "description": "時間帯（デフォルト: afternoon）" },
            "days": { "type": "array", "items": { "type": "string" }, "optional": true, "description": "曜日（デフォルト: mon-fri）" },
            "duration": { "type": "number", "optional": true, "description": "分（デフォルト: 60）" }
          }
        },
        "candidate_count": { "type": "number", "optional": true, "default": 3, "description": "候補数（デフォルト: 3）" },
        "title": { "type": "string", "optional": true, "default": "打ち合わせ", "description": "予定タイトル" },
        "send_via": { "type": "string", "enum": ["share_link", "email"], "default": "share_link", "description": "送信手段" }
      },
      "clarify_rules": {
        "invitee_name_missing": "誰との予定ですか？相手の名前を教えてください。",
        "time_range_missing": "いつ頃の予定にしますか？（例: 来週、2週間以内、2月上旬）",
        "calendar_unavailable": "カレンダー連携が使えません。Google連携状態を確認してください。",
        "no_available_slots": "指定条件で空きが見つかりませんでした。期間を広げるか、時間帯/曜日を変えてください。"
      },
      "outputs": {
        "share_url": "招待リンク（https://app.tomoniwao.jp/i/:token）",
        "message_for_chat": "AI秘書がユーザーに返す文章（候補リスト含む）",
        "thread_id": "作成されたスレッドID",
        "invite_token": "招待トークン",
        "slots": "生成された候補枠（slot_id, start_at, end_at）",
        "mode": "share_link または email",
        "constraints_used": "実際に使用された制約条件"
      },
      "executor": "frontend:executors/oneOnOne.ts::executeOneOnOneFreebusy",
      "api": "POST /api/one-on-one/freebusy/prepare",
      "examples": [
        "田中さんと来週の空いてるところから3つ候補出して送って",
        "佐藤さんに2週間以内の午後で候補3つ送って日程調整して",
        "山田さんと来週月〜金のどこかで1時間、空いてる候補を送って"
      ],
      "ui_flow": {
        "invite_page": "/i/:token - 複数候補UI（multiSlotUI）",
        "thank_you_page": "/i/:token/thank-you - 承諾後（Googleカレンダー追加 + 成長導線）"
      },
      "notes": "Phase B-2: 主催者freebusyから候補生成。slot_policy='freebusy_multi'でDB登録。相手のカレンダーは見ない（R0: 他人）。"
    },

    {
      "intent": "schedule.1on1.request_alternate",
      "category": "schedule.1on1",
      "description": "別日提案をリクエスト（招待者が提示候補に都合が合わない場合）- Phase B-3",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "topology": "1:1",
      "params_schema": {
        "invite_token": {
          "type": "string",
          "required": true,
          "description": "招待トークン"
        },
        "range": {
          "type": "string",
          "enum": ["next_week", "week_after", "any"],
          "default": "next_week",
          "description": "希望期間（来週/再来週/指定なし）"
        },
        "prefer": {
          "type": "string",
          "enum": ["morning", "afternoon", "evening", "any"],
          "default": "afternoon",
          "description": "希望時間帯"
        },
        "comment": {
          "type": "string",
          "optional": true,
          "maxLength": 200,
          "description": "補足コメント（任意）"
        }
      },
      "clarify_rules": {
        "max_repropose_exceeded": "再提案は最大2回までです。3回目以降はOpenSlotsをご利用ください。",
        "invalid_token": "無効な招待トークンです。",
        "already_responded": "この招待はすでに回答済みです。"
      },
      "outputs": {
        "success": "処理成功フラグ",
        "new_slots": "新しく生成された候補枠",
        "new_proposal_version": "更新後の提案バージョン",
        "new_propose_count": "累計再提案回数",
        "max_reached": "OpenSlotsへの誘導フラグ（2回超過時true）",
        "message": "結果メッセージ"
      },
      "executor": "frontend:executors/oneOnOne.ts::executeOneOnOneRequestAlternate",
      "api": "POST /i/:token/request-alternate",
      "examples": [
        "この日程だと都合が悪いので、来週の午後で再提案してほしい",
        "再来週でお願いします",
        "午前中の候補を出してもらえますか"
      ],
      "ui_flow": {
        "modal_form": "別日希望モーダル（期間・時間帯・補足コメント入力）",
        "success": "ページリロードで新しい候補表示",
        "max_reached": "OpenSlotsへの誘導画面表示"
      },
      "notes": "Phase B-3: 最大2回の再提案。3回目はOpenSlots(B-4)へ誘導。constraints_json更新、proposal_version+1。"
    },

    {
      "intent": "schedule.1on1.open_slots",
      "category": "schedule.1on1",
      "description": "主催者の空き枠を公開し、相手に選んでもらう（TimeRex型）- Phase B-4",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "topology": "1:1",
      "params_schema": {
        "invitee": {
          "type": "object",
          "required": true,
          "properties": {
            "name": { "type": "string", "required": true, "description": "相手の名前" },
            "email": { "type": "string", "format": "email", "optional": true, "description": "メールアドレス（send_via=email時は必須）" }
          }
        },
        "constraints": {
          "type": "object",
          "optional": true,
          "properties": {
            "time_min": { "type": "string", "format": "date-time", "optional": true, "description": "公開開始日（デフォルト: 翌営業日09:00）" },
            "time_max": { "type": "string", "format": "date-time", "optional": true, "description": "公開終了日（デフォルト: 2週間後）" },
            "prefer": { "type": "string", "enum": ["morning", "afternoon", "evening", "business", "any"], "optional": true, "description": "時間帯（デフォルト: afternoon）" },
            "days": { "type": "array", "items": { "type": "string" }, "optional": true, "description": "曜日（デフォルト: mon-fri）" },
            "duration": { "type": "number", "optional": true, "description": "分（デフォルト: 60）" },
            "slot_interval": { "type": "number", "optional": true, "description": "枠の間隔（分）（デフォルト: 30）" }
          }
        },
        "title": { "type": "string", "optional": true, "default": "打ち合わせ", "description": "予定タイトル" },
        "send_via": { "type": "string", "enum": ["share_link", "email"], "default": "share_link", "description": "送信手段" },
        "expires_in_days": { "type": "number", "optional": true, "default": 14, "description": "有効期限（日数）" }
      },
      "clarify_rules": {
        "invitee_name_missing": "誰との予定ですか？相手の名前を教えてください。",
        "time_range_missing": "いつ頃の空き枠を公開しますか？（例: 来週、2週間以内、2月上旬）",
        "calendar_unavailable": "カレンダー連携が使えません。Google連携状態を確認してください。",
        "no_available_slots": "指定条件で空きが見つかりませんでした。期間を広げるか、時間帯/曜日を変えてください。"
      },
      "outputs": {
        "share_url": "公開枠リンク（https://app.tomoniwao.jp/open/:token）",
        "message_for_chat": "AI秘書がユーザーに返す文章（リンク文言含む）",
        "thread_id": "作成されたスレッドID",
        "open_slots_token": "公開枠トークン",
        "slots_count": "生成された枠数",
        "slots": "生成された枠一覧（slot_id, start_at, end_at）",
        "time_range": "公開期間（time_min, time_max）",
        "constraints_used": "実際に使用された制約条件",
        "expires_at": "有効期限"
      },
      "executor": "frontend:executors/oneOnOne.ts::executeOneOnOneOpenSlots",
      "api": "POST /api/one-on-one/open-slots/prepare",
      "examples": [
        "田中さんに私の空いてる枠を共有して好きなところを選んでもらって",
        "佐藤さんに来週の空き枠を公開して選んでもらう",
        "山田さんと打ち合わせ、私の空き時間から選んでもらえるようにして",
        "2週間以内の午後の空き枠を公開して"
      ],
      "ui_flow": {
        "open_page": "/open/:token - 公開枠一覧UI（日付ごと・時間帯ボタン）",
        "select": "POST /open/:token/select - 枠選択",
        "thank_you_page": "/open/:token/thank-you - 選択完了（Googleカレンダー追加 + 成長導線）"
      },
      "notes": "Phase B-4: TimeRex型公開枠。open_slots/open_slot_itemsテーブルに保存。expires_atで自動失効。"
    },

    {
      "intent": "invite.prepare.emails",
      "category": "invite.prepare",
      "description": "メールアドレス貼り付けから招待準備",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "この宛先に招待を送る準備をしますか？（送る/キャンセル/別スレッドで）",
      "topology": "1:N",
      "params_schema": {
        "emails": { "type": "array", "items": { "type": "string", "format": "email" }, "required": true },
        "rawText": { "type": "string", "optional": true },
        "mode": { "type": "string", "enum": ["new_thread", "add_to_thread"], "default": "new_thread" },
        "threadId": { "type": "string", "optional": true }
      },
      "executor": "invite.prepare.emails",
      "api": "POST /api/threads/prepare-send"
    },
    {
      "intent": "invite.prepare.list",
      "category": "invite.prepare",
      "description": "リスト選択から招待準備",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "このリストに招待を送る準備をしますか？（送る/キャンセル/別スレッドで）",
      "topology": "1:N",
      "params_schema": {
        "listName": { "type": "string", "required": true },
        "mode": { "type": "string", "enum": ["new_thread", "add_to_thread"], "default": "new_thread" },
        "threadId": { "type": "string", "optional": true }
      },
      "executor": "invite.prepare.list",
      "api": "POST /api/threads/prepare-send"
    },
    {
      "intent": "pending.action.decide",
      "category": "pending.decide",
      "description": "送信決定（送る/キャンセル/別スレッドで）",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "topology": null,
      "params_schema": {
        "decision": { "type": "string", "enum": ["send", "cancel", "new_thread"], "required": true }
      },
      "executor": "pending.decide",
      "api": "POST /api/pending-actions/:token/confirm",
      "notes": "decisionがsendの場合、次のexecuteで外部送信される"
    },

    {
      "intent": "schedule.auto_propose",
      "category": "schedule.propose",
      "description": "自動調整提案",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "自動で候補日を提案しますか？（はい/いいえ）",
      "topology": "1:N",
      "params_schema": {
        "emails": { "type": "array", "optional": true },
        "duration": { "type": "integer", "default": 60 },
        "range": { "type": "string", "default": "week" }
      },
      "executor": "schedule.auto_propose",
      "api": "POST /api/threads/auto-propose"
    },
    {
      "intent": "schedule.auto_propose.confirm",
      "category": "schedule.propose",
      "description": "自動提案確定",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "executor": "schedule.auto_propose.confirm",
      "api": null
    },
    {
      "intent": "schedule.auto_propose.cancel",
      "category": "schedule.propose",
      "description": "自動提案キャンセル",
      "side_effect": "none",
      "requires_confirmation": false,
      "executor": "schedule.auto_propose.cancel",
      "api": null
    },
    {
      "intent": "schedule.additional_propose",
      "category": "schedule.propose",
      "description": "追加候補提案",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "追加候補を出しますか？（追加/キャンセル）",
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true, "source": "selectedThreadId" },
        "slots": { "type": "array", "required": true }
      },
      "executor": "schedule.additional_propose",
      "api": "POST /api/threads/:id/proposals/prepare"
    },

    {
      "intent": "schedule.remind.pending",
      "category": "schedule.remind",
      "description": "未返信者へのリマインド提案",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "未返信の人にリマインドを送りますか？（はい/いいえ）",
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true, "source": "selectedThreadId" }
      },
      "executor": "schedule.remind.pending",
      "api": "POST /api/threads/:id/remind"
    },
    {
      "intent": "schedule.remind.pending.confirm",
      "category": "schedule.remind",
      "description": "未返信リマインド確定",
      "side_effect": "write_external",
      "requires_confirmation": false,
      "executor": "schedule.remind.pending.confirm",
      "api": "POST /api/threads/:id/remind/execute"
    },
    {
      "intent": "schedule.remind.pending.cancel",
      "category": "schedule.remind",
      "description": "未返信リマインドキャンセル",
      "side_effect": "none",
      "requires_confirmation": false,
      "executor": "schedule.remind.pending.cancel",
      "api": null
    },
    {
      "intent": "schedule.need_response.list",
      "category": "schedule.remind",
      "description": "再回答必要者リスト表示",
      "side_effect": "read",
      "requires_confirmation": false,
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true, "source": "selectedThreadId" }
      },
      "executor": "schedule.need_response.list",
      "api": "GET /api/threads/:id/status"
    },
    {
      "intent": "schedule.remind.need_response",
      "category": "schedule.remind",
      "description": "再回答必要者にリマインド",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "再回答が必要な人にだけリマインドを送りますか？（はい/いいえ）",
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true },
        "targetInviteeKeys": { "type": "array", "optional": true }
      },
      "executor": "schedule.remind.need_response",
      "api": "POST /api/threads/:id/remind"
    },
    {
      "intent": "schedule.remind.need_response.confirm",
      "category": "schedule.remind",
      "description": "再回答リマインド確定",
      "side_effect": "write_external",
      "requires_confirmation": false,
      "executor": "schedule.remind.need_response.confirm",
      "api": null
    },
    {
      "intent": "schedule.remind.need_response.cancel",
      "category": "schedule.remind",
      "description": "再回答リマインドキャンセル",
      "side_effect": "none",
      "requires_confirmation": false,
      "executor": "schedule.remind.need_response.cancel",
      "api": null
    },
    {
      "intent": "schedule.remind.responded",
      "category": "schedule.remind",
      "description": "回答済み者へのリマインド",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "回答済みの人にだけ再通知しますか？（はい/いいえ）",
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true },
        "targetInviteeKeys": { "type": "array", "optional": true }
      },
      "executor": "schedule.remind.responded",
      "api": "POST /api/threads/:id/remind"
    },
    {
      "intent": "schedule.remind.responded.confirm",
      "category": "schedule.remind",
      "description": "回答済みリマインド確定",
      "side_effect": "write_external",
      "requires_confirmation": false,
      "executor": "schedule.remind.responded.confirm",
      "api": null
    },
    {
      "intent": "schedule.remind.responded.cancel",
      "category": "schedule.remind",
      "description": "回答済みリマインドキャンセル",
      "side_effect": "none",
      "requires_confirmation": false,
      "executor": "schedule.remind.responded.cancel",
      "api": null
    },

    {
      "intent": "schedule.notify.confirmed",
      "category": "schedule.notify",
      "description": "確定通知提案",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "確定を全員に通知しますか？（はい/いいえ）",
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true }
      },
      "executor": "schedule.notify.confirmed",
      "api": "POST /api/threads/:id/notify/confirmed"
    },
    {
      "intent": "schedule.notify.confirmed.confirm",
      "category": "schedule.notify",
      "description": "確定通知確定",
      "side_effect": "write_external",
      "requires_confirmation": false,
      "executor": "schedule.notify.confirmed.confirm",
      "api": null
    },
    {
      "intent": "schedule.notify.confirmed.cancel",
      "category": "schedule.notify",
      "description": "確定通知キャンセル",
      "side_effect": "none",
      "requires_confirmation": false,
      "executor": "schedule.notify.confirmed.cancel",
      "api": null
    },

    {
      "intent": "schedule.propose_for_split",
      "category": "schedule.propose",
      "description": "票割れ時の追加候補提案",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true }
      },
      "executor": "schedule.propose_for_split",
      "api": "POST /api/threads/:id/proposals/split"
    },
    {
      "intent": "schedule.propose_for_split.confirm",
      "category": "schedule.propose",
      "description": "票割れ提案確定",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "executor": "schedule.propose_for_split.confirm",
      "api": null
    },
    {
      "intent": "schedule.propose_for_split.cancel",
      "category": "schedule.propose",
      "description": "票割れ提案キャンセル",
      "side_effect": "none",
      "requires_confirmation": false,
      "executor": "schedule.propose_for_split.cancel",
      "api": null
    },

    {
      "intent": "schedule.finalize",
      "category": "schedule.commit",
      "description": "日程確定",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "この候補で確定しますか？（はい/いいえ）",
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true },
        "slotId": { "type": "string", "required": true }
      },
      "executor": "schedule.finalize",
      "api": "POST /api/threads/:id/finalize"
    },

    {
      "intent": "schedule.reschedule",
      "category": "schedule.reschedule",
      "description": "確定後の再調整（やり直し）",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "同じメンバーで新しい日程調整を開始しますか？（はい/いいえ）",
      "topology": "1:N",
      "params_schema": {
        "threadId": { "type": "string", "required": true, "source": "selectedThreadId" }
      },
      "executor": "schedule.reschedule",
      "api": "GET /api/threads/:id/reschedule/info"
    },
    {
      "intent": "schedule.reschedule.confirm",
      "category": "schedule.reschedule",
      "description": "再調整確定",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "新しい日程調整を作成し、招待の送信準備をします。よいですか？",
      "params_schema": {
        "originalThreadId": { "type": "string", "required": true },
        "participants": { "type": "array", "required": true },
        "suggestedTitle": { "type": "string", "optional": true }
      },
      "executor": "schedule.reschedule.confirm",
      "api": "POST /api/threads/prepare-send"
    },
    {
      "intent": "schedule.reschedule.cancel",
      "category": "schedule.reschedule",
      "description": "再調整キャンセル",
      "side_effect": "none",
      "requires_confirmation": false,
      "executor": "schedule.reschedule.cancel",
      "api": null
    },

    {
      "intent": "preference.set",
      "category": "preference",
      "description": "スケジュール好み設定",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "topology": null,
      "params_schema": {
        "prefs": { "type": "object", "required": true }
      },
      "executor": "preference.set",
      "api": "PUT /api/users/me/schedule-prefs"
    },
    {
      "intent": "preference.show",
      "category": "preference",
      "description": "スケジュール好み表示",
      "side_effect": "read",
      "requires_confirmation": false,
      "executor": "preference.show",
      "api": "GET /api/users/me/schedule-prefs"
    },
    {
      "intent": "preference.clear",
      "category": "preference",
      "description": "スケジュール好みクリア",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "executor": "preference.clear",
      "api": "DELETE /api/users/me/schedule-prefs"
    },

    {
      "intent": "list.create",
      "category": "list",
      "description": "リスト作成",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "params_schema": {
        "name": { "type": "string", "required": true }
      },
      "executor": "list.create",
      "api": "POST /api/lists"
    },
    {
      "intent": "list.list",
      "category": "list",
      "description": "リスト一覧表示",
      "side_effect": "read",
      "requires_confirmation": false,
      "executor": "list.list",
      "api": "GET /api/lists"
    },
    {
      "intent": "list.members",
      "category": "list",
      "description": "リストメンバー表示",
      "side_effect": "read",
      "requires_confirmation": false,
      "params_schema": {
        "listName": { "type": "string", "required": true }
      },
      "executor": "list.members",
      "api": "GET /api/lists/:id/members"
    },
    {
      "intent": "list.add_member",
      "category": "list",
      "description": "リストにメンバー追加",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "params_schema": {
        "listName": { "type": "string", "required": true },
        "email": { "type": "string", "format": "email", "required": true },
        "name": { "type": "string", "optional": true }
      },
      "executor": "list.add_member",
      "api": "POST /api/lists/:id/members",
      "examples": [
        "田中さんを営業リストに追加して",
        "tanaka@example.comをチームリストに入れて"
      ]
    },
    {
      "intent": "list.delete",
      "category": "list",
      "description": "リスト削除",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "リスト「{listName}」を削除しますか？（はい/いいえ）",
      "params_schema": {
        "listName": { "type": "string", "required": true }
      },
      "executor": "list.delete",
      "api": "DELETE /api/lists/:id",
      "examples": [
        "営業リストを削除して",
        "チームリスト消して"
      ]
    },

    {
      "intent": "contacts.add",
      "category": "contacts",
      "description": "連絡先追加（名刺等から）",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "params_schema": {
        "email": { "type": "string", "format": "email", "required": true },
        "name": { "type": "string", "optional": true },
        "phone": { "type": "string", "optional": true },
        "company": { "type": "string", "optional": true }
      },
      "executor": "contacts.add",
      "api": "POST /api/contacts",
      "examples": [
        "田中太郎さん tanaka@example.com を連絡先に追加して",
        "この名刺を登録して"
      ]
    },
    {
      "intent": "contacts.list",
      "category": "contacts",
      "description": "連絡先一覧",
      "side_effect": "read",
      "requires_confirmation": false,
      "params_schema": {
        "query": { "type": "string", "optional": true }
      },
      "executor": "contacts.list",
      "api": "GET /api/contacts",
      "examples": [
        "連絡先を見せて",
        "誰が登録されてる？"
      ]
    },

    {
      "intent": "group.create",
      "category": "group",
      "description": "グループ作成（MVPはローカル定義）",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "params_schema": {
        "groupName": { "type": "string", "required": true },
        "members": { "type": "array", "optional": true }
      },
      "executor": "group.create",
      "api": null,
      "notes": "MVPではDB未対応、pending保持のみ",
      "examples": [
        "営業チームのグループを作って",
        "開発部グループ作成"
      ]
    },
    {
      "intent": "group.list",
      "category": "group",
      "description": "グループ一覧",
      "side_effect": "read",
      "requires_confirmation": false,
      "executor": "group.list",
      "api": null,
      "examples": [
        "グループ一覧を見せて",
        "登録されてるグループは？"
      ]
    },
    {
      "intent": "group.invite",
      "category": "group",
      "description": "グループメンバーに招待送信",
      "side_effect": "write_local",
      "requires_confirmation": true,
      "confirmation_prompt": "グループ「{groupName}」のメンバーに招待を送りますか？（はい/いいえ）",
      "topology": "1:N",
      "params_schema": {
        "groupName": { "type": "string", "required": true }
      },
      "executor": "group.invite",
      "api": "POST /api/threads/prepare-send",
      "notes": "group.invite → invite.prepare.emails へ合流",
      "examples": [
        "営業チームに日程調整送って",
        "開発部グループに招待を送りたい"
      ]
    },

    {
      "intent": "schedule.fail.report",
      "category": "schedule.fail",
      "description": "調整失敗を報告（主催者手動）",
      "side_effect": "write_local",
      "requires_confirmation": false,
      "params_schema": {
        "threadId": { "type": "string", "required": true, "source": "selectedThreadId" },
        "reason": { "type": "string", "optional": true }
      },
      "executor": "schedule.fail.report",
      "api": "POST /api/threads/:id/failures/report",
      "notes": "FAIL-1 エスカレーションに接続",
      "examples": [
        "この調整うまくいかなかった",
        "日程合わなかった"
      ]
    },

    {
      "intent": "thread.summary",
      "category": "thread.read",
      "description": "スレッドの進捗要約を取得（PROG-1）",
      "side_effect": "read",
      "requires_confirmation": false,
      "params_schema": {
        "threadId": { "type": "string", "required": true, "source": "selectedThreadId" }
      },
      "executor": "thread.summary",
      "api": "GET /api/threads/:id/summary",
      "examples": [
        "今どうなってる？",
        "進捗教えて",
        "状況は？"
      ]
    },

    {
      "intent": "chat.general",
      "category": "chat",
      "description": "一般的な雑談（機能にマッチしない入力）",
      "side_effect": "none",
      "requires_confirmation": false,
      "executor": "chat.general",
      "api": "POST /api/chat/message",
      "notes": "CONV-CHATフォールバック先",
      "examples": [
        "こんにちは",
        "ありがとう",
        "お疲れ様"
      ]
    },

    {
      "intent": "unknown",
      "category": "fallback",
      "description": "分類不能（AIフォールバック対象）",
      "side_effect": "none",
      "requires_confirmation": false,
      "executor": "fallback.unknown",
      "api": null,
      "notes": "CONV-1以降でnlRouterに渡される"
    }
  ],

  "category_summary": {
    "calendar.read": "カレンダー参照（安全）",
    "calendar.read.multi": "複数参加者のカレンダー参照",
    "thread.read": "スレッド状態参照",
    "schedule.1on1": "1対1予定調整（AI秘書v1）",
    "invite.prepare": "招待準備（確認必要）",
    "pending.decide": "送信決定",
    "schedule.propose": "候補提案",
    "schedule.remind": "リマインド",
    "schedule.notify": "通知",
    "schedule.commit": "確定操作",
    "schedule.reschedule": "再調整",
    "preference": "好み設定",
    "list": "リスト管理",
    "fallback": "フォールバック"
  }
}

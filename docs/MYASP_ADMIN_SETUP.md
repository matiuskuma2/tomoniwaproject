# MyASPç®¡ç†ç”»é¢ è¨­å®šæ‰‹é †æ›¸ï¼ˆã‚³ãƒ”ãƒšç”¨ï¼‰

**Version**: v1.0  
**Status**: ç¢ºå®šï¼ˆPhase Next-11 å®Ÿè£…å¯¾è±¡ï¼‰  
**æ›´æ–°æ—¥**: 2026-01-01

---

## ğŸ“Œ ç›®çš„

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€**MyASPç®¡ç†ç”»é¢ã§tomonowaé€£æºã‚’è¨­å®šã™ã‚‹ãŸã‚ã®æ‰‹é †æ›¸**ã§ã™ã€‚
ç”»é¢æ“ä½œé †ã«æ²¿ã£ã¦ã€**ã‚³ãƒ”ãƒšã§è¨­å®šã§ãã‚‹å½¢å¼**ã§è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ” 0. äº‹å‰æº–å‚™

### å¿…è¦ãªæƒ…å ±

| é …ç›® | å€¤ | å‚™è€ƒ |
|------|-----|------|
| **POSTå…ˆURLï¼ˆæœ¬ç•ªï¼‰** | `https://app.tomoniwao.jp/api/billing/myasp/sync/694eRfw9eb4d` | å›ºå®šãƒˆãƒ¼ã‚¯ãƒ³ä»˜ã |
| **POSTå…ˆURLï¼ˆé–‹ç™ºï¼‰** | `https://dev.tomoniwao.jp/api/billing/myasp/sync/test_token_dev` | é–‹ç™ºç’°å¢ƒç”¨ |
| **å…±æœ‰ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ** | `694eRfw9eb4d` | URLæœ«å°¾ã®ãƒˆãƒ¼ã‚¯ãƒ³ |

---

## âš™ï¸ 1. MyASPç®¡ç†ç”»é¢ã«ãƒ­ã‚°ã‚¤ãƒ³

1. **MyASPç®¡ç†ç”»é¢** ã«ãƒ­ã‚°ã‚¤ãƒ³
   - URL: https://myasp.jp/admin/
2. **ã‚·ãƒŠãƒªã‚ªç®¡ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼** ã‚’é–‹ã

---

## ğŸ”— 2. å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¸ã®é€£å‹•ç™»éŒ²ï¼ˆç™»éŒ²æ™‚ï¼‰

### 2-1. è¨­å®šç”»é¢ã‚’é–‹ã

```
ã‚·ãƒŠãƒªã‚ªç®¡ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼ > å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¸ã®é€£å‹•ç™»éŒ²
```

### 2-2. æ–°è¦è¿½åŠ 

**ã€Œæ–°è¦è¿½åŠ ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

### 2-3. åŸºæœ¬è¨­å®š

| é …ç›® | è¨­å®šå€¤ |
|------|--------|
| **é€£å‹•å** | `tomonowaèª²é‡‘é€£æºï¼ˆç™»éŒ²æ™‚ï¼‰` |
| **ãƒˆãƒªã‚¬ãƒ¼** | `ä¼šå“¡ç™»éŒ²æ™‚` |
| **é€ä¿¡å…ˆURL** | `https://app.tomoniwao.jp/api/billing/myasp/sync/694eRfw9eb4d` |
| **é€ä¿¡æ–¹æ³•** | `POST` |
| **Content-Type** | `application/x-www-form-urlencoded` |

### 2-4. é€ä¿¡ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ—ãƒ©ãƒ³1ï¼šãƒ©ã‚¤ãƒˆï¼‰

**ã€Œé€ä¿¡ãƒ‡ãƒ¼ã‚¿ã€æ¬„ã«ä»¥ä¸‹ã‚’ã‚³ãƒ”ãƒš**

```
data[User][user_id]=%user_id%
data[User][mail]=%mail%
data[User][plan]=1
data[User][amount]=980
data[User][status]=1
data[User][ts]=%datetime_registration%
data[User][sig]=%mail%%user_id%
```

### 2-5. é€ä¿¡ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ—ãƒ©ãƒ³2ï¼šã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ï¼‰

**ãƒ—ãƒ©ãƒ³2ã®å ´åˆã¯ä»¥ä¸‹ã«å¤‰æ›´**

```
data[User][user_id]=%user_id%
data[User][mail]=%mail%
data[User][plan]=2
data[User][amount]=2980
data[User][status]=1
data[User][ts]=%datetime_registration%
data[User][sig]=%mail%%user_id%
```

### 2-6. é€ä¿¡ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ—ãƒ©ãƒ³3ï¼šãƒ—ãƒ­ï¼‰

**ãƒ—ãƒ©ãƒ³3ã®å ´åˆã¯ä»¥ä¸‹ã«å¤‰æ›´**

```
data[User][user_id]=%user_id%
data[User][mail]=%mail%
data[User][plan]=3
data[User][amount]=15000
data[User][status]=1
data[User][ts]=%datetime_registration%
data[User][sig]=%mail%%user_id%
```

### 2-7. ãã®ä»–è¨­å®š

| é …ç›® | è¨­å®šå€¤ |
|------|--------|
| **å†é€è¨­å®š** | âœ… æœ‰åŠ¹ï¼ˆå¤±æ•—æ™‚ã«å†é€ã™ã‚‹ï¼‰ |
| **å†é€å›æ•°** | `3å›` |
| **å†é€é–“éš”** | `5åˆ†` |
| **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ** | `30ç§’` |

### 2-8. ä¿å­˜

**ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

---

## ğŸ›‘ 3. å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¸ã®é€£å‹•ç™»éŒ²ï¼ˆåœæ­¢æ™‚ï¼‰

### 3-1. æ–°è¦è¿½åŠ 

**ã€Œæ–°è¦è¿½åŠ ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

### 3-2. åŸºæœ¬è¨­å®š

| é …ç›® | è¨­å®šå€¤ |
|------|--------|
| **é€£å‹•å** | `tomonowaèª²é‡‘é€£æºï¼ˆåœæ­¢æ™‚ï¼‰` |
| **ãƒˆãƒªã‚¬ãƒ¼** | `ä¼šå“¡åœæ­¢æ™‚` |
| **é€ä¿¡å…ˆURL** | `https://app.tomoniwao.jp/api/billing/myasp/sync/694eRfw9eb4d` |
| **é€ä¿¡æ–¹æ³•** | `POST` |
| **Content-Type** | `application/x-www-form-urlencoded` |

### 3-3. é€ä¿¡ãƒ‡ãƒ¼ã‚¿

**ã€Œé€ä¿¡ãƒ‡ãƒ¼ã‚¿ã€æ¬„ã«ä»¥ä¸‹ã‚’ã‚³ãƒ”ãƒš**

```
data[User][user_id]=%user_id%
data[User][mail]=%mail%
data[User][plan]=%plan_id%
data[User][amount]=%amount%
data[User][status]=2
data[User][ts]=%datetime_now%
data[User][sig]=%mail%%user_id%
```

**é‡è¦**: `status=2`ï¼ˆåœæ­¢ï¼‰ã«è¨­å®š

### 3-4. ä¿å­˜

**ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

---

## ğŸ”„ 4. å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¸ã®é€£å‹•ç™»éŒ²ï¼ˆå¾©æ´»æ™‚ï¼‰

### 4-1. æ–°è¦è¿½åŠ 

**ã€Œæ–°è¦è¿½åŠ ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

### 4-2. åŸºæœ¬è¨­å®š

| é …ç›® | è¨­å®šå€¤ |
|------|--------|
| **é€£å‹•å** | `tomonowaèª²é‡‘é€£æºï¼ˆå¾©æ´»æ™‚ï¼‰` |
| **ãƒˆãƒªã‚¬ãƒ¼** | `ä¼šå“¡å¾©æ´»æ™‚` |
| **é€ä¿¡å…ˆURL** | `https://app.tomoniwao.jp/api/billing/myasp/sync/694eRfw9eb4d` |
| **é€ä¿¡æ–¹æ³•** | `POST` |
| **Content-Type** | `application/x-www-form-urlencoded` |

### 4-3. é€ä¿¡ãƒ‡ãƒ¼ã‚¿

**ã€Œé€ä¿¡ãƒ‡ãƒ¼ã‚¿ã€æ¬„ã«ä»¥ä¸‹ã‚’ã‚³ãƒ”ãƒš**

```
data[User][user_id]=%user_id%
data[User][mail]=%mail%
data[User][plan]=%plan_id%
data[User][amount]=%amount%
data[User][status]=3
data[User][ts]=%datetime_now%
data[User][sig]=%mail%%user_id%
```

**é‡è¦**: `status=3`ï¼ˆå¾©æ´»ï¼‰ã«è¨­å®š

### 4-4. ä¿å­˜

**ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

---

## âŒ 5. å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¸ã®é€£å‹•ç™»éŒ²ï¼ˆè§£ç´„æ™‚ï¼‰

### 5-1. æ–°è¦è¿½åŠ 

**ã€Œæ–°è¦è¿½åŠ ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

### 5-2. åŸºæœ¬è¨­å®š

| é …ç›® | è¨­å®šå€¤ |
|------|--------|
| **é€£å‹•å** | `tomonowaèª²é‡‘é€£æºï¼ˆè§£ç´„æ™‚ï¼‰` |
| **ãƒˆãƒªã‚¬ãƒ¼** | `ä¼šå“¡è§£ç´„æ™‚` |
| **é€ä¿¡å…ˆURL** | `https://app.tomoniwao.jp/api/billing/myasp/sync/694eRfw9eb4d` |
| **é€ä¿¡æ–¹æ³•** | `POST` |
| **Content-Type** | `application/x-www-form-urlencoded` |

### 5-3. é€ä¿¡ãƒ‡ãƒ¼ã‚¿

**ã€Œé€ä¿¡ãƒ‡ãƒ¼ã‚¿ã€æ¬„ã«ä»¥ä¸‹ã‚’ã‚³ãƒ”ãƒš**

```
data[User][user_id]=%user_id%
data[User][mail]=%mail%
data[User][plan]=%plan_id%
data[User][amount]=%amount%
data[User][status]=4
data[User][ts]=%datetime_now%
data[User][sig]=%mail%%user_id%
```

**é‡è¦**: `status=4`ï¼ˆè§£ç´„ï¼‰ã«è¨­å®š

### 5-4. ä¿å­˜

**ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

---

## ğŸ”„ 6. ãƒ—ãƒ©ãƒ³å¤‰æ›´æ™‚ã®è¨­å®š

### 6-1. æ–°è¦è¿½åŠ 

**ã€Œæ–°è¦è¿½åŠ ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

### 6-2. åŸºæœ¬è¨­å®š

| é …ç›® | è¨­å®šå€¤ |
|------|--------|
| **é€£å‹•å** | `tomonowaèª²é‡‘é€£æºï¼ˆãƒ—ãƒ©ãƒ³å¤‰æ›´æ™‚ï¼‰` |
| **ãƒˆãƒªã‚¬ãƒ¼** | `ãƒ—ãƒ©ãƒ³å¤‰æ›´æ™‚` |
| **é€ä¿¡å…ˆURL** | `https://app.tomoniwao.jp/api/billing/myasp/sync/694eRfw9eb4d` |
| **é€ä¿¡æ–¹æ³•** | `POST` |
| **Content-Type** | `application/x-www-form-urlencoded` |

### 6-3. é€ä¿¡ãƒ‡ãƒ¼ã‚¿

**ã€Œé€ä¿¡ãƒ‡ãƒ¼ã‚¿ã€æ¬„ã«ä»¥ä¸‹ã‚’ã‚³ãƒ”ãƒš**

```
data[User][user_id]=%user_id%
data[User][mail]=%mail%
data[User][plan]=%plan_id_after%
data[User][amount]=%amount_after%
data[User][status]=1
data[User][ts]=%datetime_now%
data[User][sig]=%mail%%user_id%
```

**é‡è¦**: 
- `%plan_id_after%` = å¤‰æ›´å¾Œã®ãƒ—ãƒ©ãƒ³ID
- `%amount_after%` = å¤‰æ›´å¾Œã®é‡‘é¡
- `status=1`ï¼ˆæœ‰åŠ¹ï¼‰ã«è¨­å®š

### 6-4. ä¿å­˜

**ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

---

## ğŸ§ª 7. ãƒ†ã‚¹ãƒˆé€ä¿¡

### 7-1. ãƒ†ã‚¹ãƒˆé€ä¿¡æ©Ÿèƒ½ã‚’ä½¿ç”¨

1. **è¨­å®šã—ãŸé€£å‹•ã‚’é¸æŠ**
2. **ã€Œãƒ†ã‚¹ãƒˆé€ä¿¡ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**
3. **ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å…¥åŠ›**
   - user_id: `test_12345`
   - mail: `test@example.com`
   - plan: `3`
   - amount: `15000`
4. **ã€Œé€ä¿¡ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

### 7-2. çµæœç¢ºèª

- **æˆåŠŸ**: `200 OK` ãŒè¿”ã£ã¦ãã‚‹ã“ã¨
- **å¤±æ•—**: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã—ã€URLãƒ»ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å†ç¢ºèª

---

## ğŸ“‹ 8. è¨­å®šãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### å¿…é ˆè¨­å®š
- [ ] ç™»éŒ²æ™‚ã®é€£å‹•è¨­å®šï¼ˆãƒ—ãƒ©ãƒ³1/2/3ï¼‰
- [ ] åœæ­¢æ™‚ã®é€£å‹•è¨­å®š
- [ ] å¾©æ´»æ™‚ã®é€£å‹•è¨­å®š
- [ ] è§£ç´„æ™‚ã®é€£å‹•è¨­å®š
- [ ] ãƒ—ãƒ©ãƒ³å¤‰æ›´æ™‚ã®é€£å‹•è¨­å®š

### ä»»æ„è¨­å®š
- [ ] å†é€è¨­å®šï¼ˆ3å›ãƒ»5åˆ†é–“éš”ï¼‰
- [ ] ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆ30ç§’ï¼‰
- [ ] ãƒ†ã‚¹ãƒˆé€ä¿¡ç¢ºèª

---

## ğŸš¨ 9. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼1: 401 Unauthorized

**åŸå› **: URLãƒˆãƒ¼ã‚¯ãƒ³ãŒé–“é•ã£ã¦ã„ã‚‹

**å¯¾ç­–**: POSTå…ˆURLã‚’ç¢ºèª
```
æ­£: https://app.tomoniwao.jp/api/billing/myasp/sync/694eRfw9eb4d
èª¤: https://app.tomoniwao.jp/api/billing/myasp/sync/wrong_token
```

### ã‚¨ãƒ©ãƒ¼2: 400 Bad Request

**åŸå› **: plan ã¨ amount ãŒçŸ›ç›¾ã—ã¦ã„ã‚‹

**å¯¾ç­–**: é€ä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
```
æ­£: plan=1, amount=980
èª¤: plan=1, amount=15000
```

### ã‚¨ãƒ©ãƒ¼3: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

**åŸå› **: tomonowaå´ã®ã‚µãƒ¼ãƒãƒ¼ãŒå¿œç­”ã—ã¦ã„ãªã„

**å¯¾ç­–**: 
1. tomonowaå´ã®ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ã‚’ç¢ºèª
2. ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ã‚’å»¶é•·ï¼ˆ30ç§’ â†’ 60ç§’ï¼‰

---

## ğŸ“š å‚ç…§æ–‡æ›¸

- [MYASP_INTEGRATION_SPEC.md](./MYASP_INTEGRATION_SPEC.md): é–‹ç™ºãƒãƒ¼ãƒ å‘ã‘å®Ÿè£…ä»•æ§˜æ›¸
- [BILLING_AND_LIMITS.md](./BILLING_AND_LIMITS.md): èª²é‡‘ãƒ—ãƒ©ãƒ³ã¨åˆ¶é™å€¤ã®è¨­è¨ˆ

---

## æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ | æ›´æ–°è€… |
|------|------------|----------|--------|
| 2026-01-01 | v1.0 | åˆç‰ˆä½œæˆï¼ˆMyASPè¨­å®šæ‰‹é †æ›¸ï¼‰ | é–‹ç™ºãƒãƒ¼ãƒ  |
